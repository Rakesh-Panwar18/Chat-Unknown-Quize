<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Question Logger</title>
  <style>
    :root{
      --bg:#f5f7fa;
      --card:#ffffff;
      --text:#1f2937;
      --muted:#6b7280;
      --primary:#0f62fe;
      --primary-600:#0b57d0;
      --border:#d1d5db;
      --chip:#eef2ff;
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family:system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
      background:var(--bg); color:var(--text);
      min-height:100vh; display:flex; align-items:center; justify-content:center;
      padding:24px;
    }
    .card{
      width:100%; max-width:520px; background:var(--card);
      border-radius:16px; padding:28px; box-shadow:0 10px 30px rgba(0,0,0,.08);
    }
    h1{margin:0 0 4px; font-size:22px; font-weight:700}
    .sub{color:var(--muted); font-size:14px; margin-bottom:18px}
    label{display:block; font-size:13px; font-weight:600; color:#374151; margin:14px 0 6px}
    input, select{
      width:100%; padding:12px 12px; border:1px solid var(--border);
      border-radius:10px; font-size:15px; background:#fff; outline:none;
    }
    input[readonly]{background:#f9fafb; color:#4b5563}
    button{
      width:100%; margin-top:18px; padding:12px 14px; border:none; border-radius:10px;
      background:var(--primary); color:#fff; font-weight:700; font-size:15px; cursor:pointer;
      box-shadow:0 6px 14px rgba(15,98,254,.25); transition:background .15s ease, transform .05s ease;
    }
    button:hover{background:var(--primary-600)}
    button:active{transform:translateY(1px)}
    .msg{margin-top:10px; font-size:13px; text-align:center}
    .msg.ok{color:#16a34a} .msg.err{color:#dc2626}
    .list-wrap{margin-top:24px}
    .list-title{font-size:16px; font-weight:700; margin:0 0 10px}
    .empty{color:var(--muted); font-size:14px}
    .item{
      display:flex; gap:10px; align-items:flex-start;
      background:#f8fafc; border:1px solid #e5e7eb; border-left:4px solid var(--primary);
      padding:10px 12px; border-radius:10px; margin-bottom:10px;
    }
    .q{font-weight:600}
    .chip{
      margin-left:auto; background:var(--chip); color:#3730a3; font-size:12px; font-weight:700;
      padding:4px 8px; border-radius:999px; white-space:nowrap; border:1px solid #e0e7ff;
    }
    .footer-note{margin-top:8px; color:var(--muted); font-size:12px; text-align:center}
  </style>
</head>
<body>
  <div class="card">
    <h1>Log a Question</h1>
    <div class="sub">Date auto-fill • Answer baad me sheet me fill karna</div>

    <form id="qForm" autocomplete="off">
      <label for="date">Date</label>
      <input id="date" type="text" readonly />

      <label for="question">Question *</label>
      <input id="question" type="text" placeholder="Type the customer question…" required />

      <label for="category">Category</label>
      <select id="category">
        <option>📄 Welcome</option>
        <option>🔚 Closing</option>
        <option>⏳ Delay in Issue Resolution</option>
        <option>💸 Withdrawal Issue</option>
        <option>💰 Deposit Issue</option>
        <option>🎫 Voucher Related</option>
        <option>🎯 Missed Call</option>
        <option>👔 VIP Manager Transfer</option>
        <option>🛠 Technical Issue</option>
        <option>🚫 Security Team Contact</option>
        <option>🔒 Trust & Transparency</option>
        <option>📦 Promotion</option>
        <option>🎮 Client Loss</option>
        <option>🙋 Player Concerns</option>
        <option>🎰 Casino Bonus</option>
        <option>✅ Voucher Confirmation</option>
        <option>🔐 OTP Issue</option>
        <option>Other</option>
      </select>

      <button type="submit" id="saveBtn">Save to Sheet</button>
      <div id="msg" class="msg" aria-live="polite"></div>
    </form>

    <div class="list-wrap">
      <p class="list-title">Today’s Added Questions</p>
      <div id="list"><div class="empty">No questions logged yet.</div></div>
      <div class="footer-note">List yahin rahegi jab tak aap page refresh nahi karte.</div>
    </div>
  </div>

  <script>
    // === CONFIG: Your Apps Script Web App URL ===
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbz08JWg3gLgWIJP87luwYwHyhiXZnh9fa500q1KyEfijiw44e-MLlgj5o-lsm1r6ECphg/exec";

    // Prefill today's date
    const dateInput = document.getElementById('date');
    dateInput.value = new Date().toLocaleDateString();

    const msg = document.getElementById('msg');
    const list = document.getElementById('list');
    const form = document.getElementById('qForm');
    const todayItems = [];

    function renderList(){
      if (!todayItems.length){
        list.innerHTML = '<div class="empty">No questions logged yet.</div>';
        return;
      }
      list.innerHTML = todayItems.map(item => `
        <div class="item">
          <div class="q">${item.question}</div>
          <div class="chip">${item.category}</div>
        </div>`).join('');
    }

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      msg.textContent = '';
      msg.className = 'msg';

      const payload = {
        date: dateInput.value,
        question: document.getElementById('question').value.trim(),
        category: document.getElementById('category').value,
        answer: "" // blank for now
      };

      if (!payload.question){
        msg.textContent = 'Please enter a question.';
        msg.className = 'msg err';
        return;
      }

      try {
        const res = await fetch(SCRIPT_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload)
        });

        // Some deployments may return text/plain; try both
        let data;
        const text = await res.text();
        try { data = JSON.parse(text); } catch { data = { ok: res.ok, raw: text }; }

        if (data && data.ok){
          todayItems.unshift({ question: payload.question, category: payload.category });
          renderList();
          form.reset();
          dateInput.value = new Date().toLocaleDateString();
          msg.textContent = 'Saved successfully!';
          msg.className = 'msg ok';
          setTimeout(() => { msg.textContent = ''; msg.className = 'msg'; }, 1800);
        } else {
          throw new Error((data && data.error) ? data.error : 'Unknown error');
        }
      } catch (err){
        msg.textContent = 'Failed to save: ' + err.message;
        msg.className = 'msg err';
      }
    });

    renderList();
  </script>
</body>
</html>
